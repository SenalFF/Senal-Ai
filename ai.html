<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Senal AI Web</title>
  <meta name="description" content="Senal AI â€” your intelligent Sinhala and English assistant created by Mr Senal.">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <script src="https://accounts.google.com/gsi/client" async defer></script>
  <style>
    :root {
      --bg: #0d1117;
      --fg: #f0f6fc;
      --accent: #6366f1;
      --card: #161b22;
    }
    body {
      margin: 0; font-family: 'Poppins', sans-serif;
      background: var(--bg); color: var(--fg);
      display: flex; flex-direction: column; height: 100vh;
    }
    header {
      text-align: center; padding: 1.2rem 0;
    }
    header h1 { color: var(--accent); margin: 0; font-size: 1.8rem; }
    main {
      flex: 1; overflow-y: auto; padding: 1rem;
    }
    .message {
      max-width: 80%; padding: 0.8rem 1rem; margin: 0.4rem 0;
      border-radius: 1rem; line-height: 1.4;
    }
    .user { background: var(--accent); color: white; margin-left: auto; }
    .ai { background: var(--card); color: var(--fg); margin-right: auto; }
    footer {
      display: flex; gap: 0.5rem; padding: 0.8rem;
      background: var(--card);
    }
    footer input {
      flex: 1; border: none; outline: none;
      padding: 0.6rem; border-radius: 0.6rem;
      font-size: 1rem;
    }
    footer button {
      background: var(--accent); border: none; color: white;
      padding: 0.6rem 1rem; border-radius: 0.6rem;
      cursor: pointer;
    }
    /* Floating contact button */
    #contactBtn {
      position: fixed; bottom: 90px; right: 20px;
      background: var(--accent); color: white;
      border: none; border-radius: 50%;
      width: 56px; height: 56px; font-size: 1.6rem;
      cursor: pointer; box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    }
    #contactPopup {
      position: fixed; bottom: 160px; right: 20px;
      background: var(--card); padding: 1rem;
      border-radius: 1rem; display: none;
      box-shadow: 0 2px 10px rgba(0,0,0,0.4);
      min-width: 220px;
    }
    #contactPopup h3 { margin-top: 0; color: var(--accent); }
    #contactPopup a { color: var(--fg); text-decoration: none; display: block; margin: 4px 0; }
    #contactPopup a:hover { text-decoration: underline; }
  </style>
</head>
<body>

<header>
  <h1>Welcome to Senal AI</h1>
  <p>Powered by Gemini 2.0 â€” created by Mr Senal</p>
</header>

<main id="chatBox"></main>

<footer>
  <input id="userInput" type="text" placeholder="Type your message..." />
  <button id="sendBtn">Send</button>
</footer>

<!-- Floating contact button + popup -->
<button id="contactBtn">ðŸ’¬</button>
<div id="contactPopup">
  <h3>Contact Mr Senal</h3>
  <a href="mailto:senalmd57@gmail.com">ðŸ“§ senalmd57@gmail.com</a>
  <a href="https://wa.me/94769872326" target="_blank">ðŸ“ž WhatsApp 0769872326</a>
</div>

<script>
const API_KEY = "AIzaSyBunZU5v1QTKAkXevdEbvaOhKoJtb8-rmQ"; // replace with your Gemini API key
const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${API_KEY}`;
const SYSTEM_PROMPT = `You are 'Senal AI', a friendly, intelligent Sinhala and English-speaking assistant created by Mr Senal. Be polite, clear, and helpful.`;

const chatBox = document.getElementById("chatBox");
const userInput = document.getElementById("userInput");
const sendBtn = document.getElementById("sendBtn");
const contactBtn = document.getElementById("contactBtn");
const contactPopup = document.getElementById("contactPopup");

contactBtn.addEventListener("click", () => {
  contactPopup.style.display = contactPopup.style.display === "none" || contactPopup.style.display === "" ? "block" : "none";
});

async function sendMessage() {
  const text = userInput.value.trim();
  if (!text) return;
  appendMessage("user", text);
  userInput.value = "";
  appendMessage("ai", "Typing...");
  try {
    const body = {
      contents: [{ role: "user", parts: [{ text: SYSTEM_PROMPT + "\nUser: " + text }] }]
    };
    const res = await fetch(API_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(body)
    });
    const data = await res.json();
    const aiText = data?.candidates?.[0]?.content?.parts?.[0]?.text || "Sorry, I couldnâ€™t process that.";
    replaceLastMessage(aiText);
  } catch (err) {
    replaceLastMessage("Error: " + err.message);
  }
}

function appendMessage(sender, text) {
  const msg = document.createElement("div");
  msg.className = `message ${sender}`;
  msg.textContent = text;
  chatBox.appendChild(msg);
  chatBox.scrollTop = chatBox.scrollHeight;
}

function replaceLastMessage(newText) {
  const msgs = chatBox.getElementsByClassName("message");
  if (msgs.length > 0) {
    msgs[msgs.length - 1].textContent = newText;
  }
  chatBox.scrollTop = chatBox.scrollHeight;
}

sendBtn.addEventListener("click", sendMessage);
userInput.addEventListener("keypress", e => { if (e.key === "Enter") sendMessage(); });
</script>

</body>
</html>
